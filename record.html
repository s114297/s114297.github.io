<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>ç´€éŒ„é </title>
</head>
<body>
<hr>

<h2>ğŸ† æ’è¡Œæ¦œï¼ˆå‰ 10 åï¼‰</h2>

<ol id="rankList">
  <!-- æ’è¡Œæ¦œæœƒé¡¯ç¤ºåœ¨é€™è£¡ -->
</ol>

<h1>ç´€éŒ„é </h1>

<!-- é¡¯ç¤ºæš±ç¨± -->
<p>ä½ å¥½ï¼Œ<span id="userName"></span> ğŸ‘‹</p>

<hr>

<!-- å€‹äººç´€éŒ„å€ -->
<h2>å€‹äººç´€éŒ„å€</h2>

<label>æ™‚é–“</label><br>
<input type="datetime-local" id="time"><br><br>

<label>å¦‚å»ç‹€æ³ï¼ˆå·¦ï¼šä¸èˆ’æœ â†’ å³ï¼šèˆ’æœï¼‰</label><br>
<input type="range" min="1" max="5" id="feel"><br><br>

<label>å‚™è¨»ï¼ˆéå¿…å¡«ï¼‰</label><br>
<input id="note"><br><br>

<button onclick="addRecord()">æ–°å¢è³‡æ–™</button>

<hr>

<!-- é¡¯ç¤ºç´€éŒ„çš„åœ°æ–¹ -->
<h2>æˆ‘çš„ç´€éŒ„</h2>
<ul id="recordList"></ul>
<script>
/* ===== æˆ¿é–“åŠŸèƒ½ ===== */

// ç”¢ç”Ÿè‹±æ•¸æ··åˆä»£ç¢¼
function makeRoomCode() {
  return Math.random().toString(36).substring(2, 8).toUpperCase();
}

// å‰µå»ºæˆ¿é–“
function createRoom() {
  let code = makeRoomCode();

  // å­˜é€²ç€è¦½å™¨
  localStorage.setItem("roomCode", code);

  // é¡¯ç¤ºåœ¨ç•«é¢ä¸Š
  document.getElementById("roomText").innerText =
    "ä½ çš„æˆ¿é–“ä»£ç¢¼æ˜¯ï¼š" + code;
}

// åŠ å…¥æˆ¿é–“
function joinRoom() {
  let code = document.getElementById("roomInput").value;

  if (code === "") {
    alert("è«‹è¼¸å…¥æˆ¿é–“ä»£ç¢¼");
    return;
  }

  localStorage.setItem("roomCode", code);

  document.getElementById("roomText").innerText =
    "ä½ å·²åŠ å…¥æˆ¿é–“ï¼š" + code;
}

// é‡æ–°æ•´ç†å¾Œä»é¡¯ç¤ºæˆ¿é–“
let savedRoom = localStorage.getItem("roomCode");
if (savedRoom) {
  document.getElementById("roomText").innerText =
    "ç›®å‰æ‰€åœ¨æˆ¿é–“ï¼š" + savedRoom;
}
</script>

<script>
/* ========= è®€å–æš±ç¨± ========= */
let nickname = localStorage.getItem("nickname");
document.getElementById("userName").innerText = nickname;


/* ========= è®€å–å·²å­˜çš„ç´€éŒ„ ========= */
let records = JSON.parse(localStorage.getItem("records")) || [];

// ä¸€é€²é é¢å°±é¡¯ç¤ºæ‰€æœ‰ç´€éŒ„
records.forEach(showRecord);


/* ========= æ–°å¢ç´€éŒ„ ========= */
function addRecord() {// å¦‚æœæ’è¡Œæ¦œè£¡é‚„æ²’æœ‰é€™å€‹äººï¼Œå…ˆçµ¦ 0 åˆ†
if (!scores[userName]) {
  scores[userName] = 0;
}

// æ–°å¢ä¸€ç­†ç´€éŒ„ï¼Œåˆ†æ•¸ +1
scores[userName]++;

// å­˜å› localStorage
localStorage.setItem("scores", JSON.stringify(scores));

// æ›´æ–°æ’è¡Œæ¦œç•«é¢
updateRank();


  let time = document.getElementById("time").value;
  let feel = document.getElementById("feel").value;
  let note = document.getElementById("note").value;

  // æŠŠä¸€ç­†è³‡æ–™è®Šæˆä¸€å€‹ç‰©ä»¶
  let record = {
    time: time,
    feel: feel,
    note: note || "ç„¡"
  };

  // åŠ é€²é™£åˆ—
  records.push(record);

  // å­˜é€² localStorage
  localStorage.setItem("records", JSON.stringify(records));

  // é¡¯ç¤ºåœ¨ç•«é¢
  showRecord(record);
}


/* ========= é¡¯ç¤ºå–®ç­†ç´€éŒ„ ========= */
function showRecord(record) {

  let li = document.createElement("li");
  li.innerText =
    "æ™‚é–“ï¼š" + record.time +
    "ï½œç‹€æ³ï¼š" + record.feel +
    "ï½œå‚™è¨»ï¼š" + record.note;

  document.getElementById("recordList").appendChild(li);
}
  <script>
/* ========= æ’è¡Œæ¦œè³‡æ–™ ========= */

// å¾ localStorage è®€å–æ’è¡Œæ¦œè³‡æ–™
let scores = JSON.parse(localStorage.getItem("scores")) || {};

// ä½¿ç”¨è€…æš±ç¨±
let userName = localStorage.getItem("nickname");

// é¡¯ç¤ºæ’è¡Œæ¦œ
updateRank();

/* ========= æ›´æ–°æ’è¡Œæ¦œ ========= */
function updateRank() {

  let list = document.getElementById("rankList");
  list.innerHTML = "";

  // æŠŠç‰©ä»¶è½‰æˆé™£åˆ—ï¼Œæ–¹ä¾¿æ’åº
  let scoreArray = [];

  for (let name in scores) {
    scoreArray.push({
      name: name,
      score: scores[name]
    });
  }

  // ä¾åˆ†æ•¸ç”±é«˜åˆ°ä½æ’åº
  scoreArray.sort(function(a, b) {
    return b.score - a.score;
  });

  // åªé¡¯ç¤ºå‰ 10 å
  scoreArray.slice(0, 10).forEach(function(item) {
    let li = document.createElement("li");
    li.innerText = item.name + " ï¼š " + item.score + " æ¬¡";
    list.appendChild(li);
  });
}
</script>

</script>
<hr>

<h2>å’Œæœ‹å‹ä¸€èµ·ç©</h2>

<button onclick="createRoom()">å‰µå»ºæˆ¿é–“</button>

<p id="roomText">ç›®å‰å°šæœªåŠ å…¥æˆ¿é–“</p>

<input id="roomInput" placeholder="è¼¸å…¥æˆ¿é–“ä»£ç¢¼">

<button onclick="joinRoom()">åŠ å…¥æˆ¿é–“</button>


</body>
</html>


